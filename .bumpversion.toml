[tool.bumpversion]
current_version = "3.0.0a1"
tag_name = "v{new_version}"
commit = false
allow_dirty = true
tag = true
message = "Bump version: {current_version} â†’ {new_version}"

parse = """(?x)
  (?P<major>\\d+)\\.
  (?P<minor>\\d+)\\.
  (?P<patch>\\d+)
  (?:(?P<release>[ab])(?P<build>\\d+))?
  (?:\\+(?P<branch>[A-Za-z0-9_.-]+))?
"""
serialize = [
   "{major}.{minor}.{patch}{release}{build}+{branch}",
   "{major}.{minor}.{patch}{release}{build}",
   "{major}.{minor}.{patch}+{branch}",
   "{major}.{minor}.{patch}"
]

[tool.bumpversion.parts.release]
optional_value = ""
values = ["a", "b", ""]

[tool.bumpversion.parts.build]
first_value = "1"

[tool.bumpversion.parts.branch]
optional_value = ""

[[tool.bumpversion.files]]
filename = "pyproject.toml"
search = "version = \"{current_version}\""
replace = "version = \"{new_version}\""

[[tool.bumpversion.files]]
filename = "defs.mk"
search = "VERSION = {current_version}"
replace = "VERSION = {new_version}"

[[tool.bumpversion.files]]
filename = "src/flair/__init__.py"
search = "VERSION = \"{current_version}\""
replace = "VERSION = \"{new_version}\""

[[tool.bumpversion.files]]
filename = "misc/Dockerfile"
search = "flair-brookslab==v{current_version}"
replace = "flair-brookslab==v{new_version}"

[[tool.bumpversion.files]]
filename = "misc/flair_conda_env.yaml"
search = "flair-brookslab==v{current_version}"
replace = "flair-brookslab==v{new_version}"

[[tool.bumpversion.files]]
filename = "misc/flair_diffexp_conda_env.yaml"
search = "flair-brookslab[diffexp]==v{current_version}"
replace = "flair-brookslab[diffexp]==v{new_version}"

[[tool.bumpversion.files]]
filename = "docs/source/installing.rst"
search = "download/v{current_version}/"
replace = "download/v{new_version}/"

[[tool.bumpversion.files]]
filename = "docs/source/installing.rst"
search = "/flair:{current_version}"
replace = "/flair:{new_version}"

